/*
 tableExport.jquery.plugin

 Copyright (c) 2015,2016 hhurz, https://github.com/hhurz/tableExport.jquery.plugin
 Original work Copyright (c) 2014 Giri Raj, https://github.com/kayalshri/

 Licensed under the MIT License, http://opensource.org/licenses/mit-license
*/
(function(b){b.fn.extend({tableExport:function(v){function R(f){var a=[];b(f).find("thead").first().find("th").each(function(f,e){void 0!==b(e).attr("data-field")?a[f]=b(e).attr("data-field"):a[f]=f.toString()});return a}function y(f,h,d,e,w){if(-1==b.inArray(d,a.ignoreRow)&&-1==b.inArray(d-e,a.ignoreRow)){var l=b(f).filter(function(){return"none"!=b(this).data("tableexport-display")&&(b(this).is(":visible")||"always"==b(this).data("tableexport-display")||"always"==b(this).closest("table").data("tableexport-display"))}).find(h),
m=0;l.each(function(f){if("always"==b(this).data("tableexport-display")||"none"!=b(this).css("display")&&"hidden"!=b(this).css("visibility")&&"none"!=b(this).data("tableexport-display")){var h=f,e=!1;0<a.ignoreColumn.length&&("string"==typeof a.ignoreColumn[0]?H.length>h&&"undefined"!=typeof H[h]&&-1!=b.inArray(H[h],a.ignoreColumn)&&(e=!0):"number"!=typeof a.ignoreColumn[0]||-1==b.inArray(h,a.ignoreColumn)&&-1==b.inArray(h-l.length,a.ignoreColumn)||(e=!0));if(0==e&&"function"===typeof w){var e=0,
g,k=0;if("undefined"!=typeof z[d]&&0<z[d].length)for(h=0;h<=f;h++)"undefined"!=typeof z[d][h]&&(w(null,d,h),delete z[d][h],f++);b(this).is("[colspan]")&&(e=parseInt(b(this).attr("colspan")),m+=0<e?e-1:0);b(this).is("[rowspan]")&&(k=parseInt(b(this).attr("rowspan")));w(this,d,f);for(h=0;h<e-1;h++)w(null,d,f+h);if(k)for(g=1;g<k;g++)for("undefined"==typeof z[d+g]&&(z[d+g]=[]),z[d+g][f+m]="",h=1;h<e;h++)z[d+g][f+m-h]=""}}});if("undefined"!=typeof z[d]&&0<z[d].length)for(c=0;c<=z[d].length;c++)"undefined"!=
typeof z[d][c]&&(w(null,d,c),delete z[d][c])}}function ca(f){!0===a.consoleLog&&console.log(f.output());if("string"===a.outputMode)return f.output();if("base64"===a.outputMode)return F(f.output());try{var h=f.output("blob");saveAs(h,a.fileName+".pdf")}catch(d){C(a.fileName+".pdf","data:application/pdf;base64,",f.output())}}function da(f,a,d){var e=0;"undefined"!=typeof d&&(e=d.colspan);if(0<=e){for(var b=f.width,l=f.textPos.x,m=a.table.columns.indexOf(a.column),S=1;S<e;S++)b+=a.table.columns[m+S].width;
1<e&&("right"===f.styles.halign?l=f.textPos.x+b-f.width:"center"===f.styles.halign&&(l=f.textPos.x+(b-f.width)/2));f.width=b;f.textPos.x=l;"undefined"!=typeof d&&1<d.rowspan&&(f.height*=d.rowspan);if("middle"===f.styles.valign||"bottom"===f.styles.valign)d=("string"===typeof f.text?f.text.split(/\r\n|\r|\n/g):f.text).length||1,2<d&&(f.textPos.y-=(2-1.15)/2*a.row.styles.fontSize*(d-2)/3);return!0}return!1}function ea(f,a,d){"undefined"!=typeof d.images&&a.each(function(){var a=b(this).children();if(b(this).is("img")){var h=
T(this.src);d.images[h]={url:this.src,src:this.src}}"undefined"!=typeof a&&0<a.length&&ea(f,a,d)})}function ka(f,a){function d(f){if(f.url){var e=new Image;b=++l;e.crossOrigin="Anonymous";e.onerror=e.onload=function(){if(e.complete&&(0===e.src.indexOf("data:image/")&&(e.width=f.width||e.width||0,e.height=f.height||e.height||0),e.width+e.height)){T(f.url);var d=document.createElement("canvas"),g=d.getContext("2d");d.width=e.width;d.height=e.height;g.drawImage(e,0,0);f.src=d.toDataURL("image/jpeg")}--l||
a(b)};e.src=f.url}}var e,b=0,l=0;if("undefined"!=typeof f.images)for(e in f.images)f.images.hasOwnProperty(e)&&d(f.images[e]);(e=l)||(a(b),e=void 0);return e}function fa(f,h,d){h.each(function(){var e=b(this).children();if(b(this).is("div")){var h=N(D(this,"background-color"),[255,255,255]),l=N(D(this,"border-top-color"),[0,0,0]),m=O(this,"border-top-width",a.jspdf.unit),g=this.getBoundingClientRect(),k=this.offsetLeft*d.dw,p=this.offsetTop*d.dh,n=g.width*d.dw,g=g.height*d.dh;d.doc.setDrawColor.apply(void 0,
l);d.doc.setFillColor.apply(void 0,h);d.doc.setLineWidth(m);d.doc.rect(f.x+k,f.y+p,n,g,m?"FD":"F")}else b(this).is("img")&&"undefined"!=typeof d.images&&(h=T(this.src),h=d.images[h],"undefined"!=typeof h&&(d.doc.addImage(h.src,f.textPos.x,f.y,this.width,this.height),f.textPos.x+=this.width));"undefined"!=typeof e&&0<e.length&&fa(f,e,d)})}function U(f,a,d){return f.replace(new RegExp(a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),d)}function la(f){f=U(f||"0",a.numbers.html.decimalMark,".");f=
U(f,a.numbers.html.thousandsSeparator,"");return"number"===typeof f||!1!==jQuery.isNumeric(f)?f:!1}function x(f,h,d){var e="";if(null!=f){f=b(f);var w;w=f[0].hasAttribute("data-tableexport-value")?f.data("tableexport-value"):f.html();"function"===typeof a.onCellHtmlData&&(w=a.onCellHtmlData(f,h,d,w));if(!0===a.htmlContent)e=b.trim(w);else{var l=w.replace(/\n/g,"\u2028").replace(/<br\s*[\/]?>/gi,"\u2060");w=b("<div/>").html(l).contents();l="";b.each(w.text().split("\u2028"),function(f,a){0<f&&(l+=
" ");l+=b.trim(a)});b.each(l.split("\u2060"),function(f,a){0<f&&(e+="\n");e+=b.trim(a).replace(/\u00AD/g,"")});if(a.numbers.html.decimalMark!=a.numbers.output.decimalMark||a.numbers.html.thousandsSeparator!=a.numbers.output.thousandsSeparator)if(w=la(e),!1!==w){var m=(""+w).split(".");1==m.length&&(m[1]="");var g=3<m[0].length?m[0].length%3:0,e=(0>w?"-":"")+(a.numbers.output.thousandsSeparator?(g?m[0].substr(0,g)+a.numbers.output.thousandsSeparator:"")+m[0].substr(g).replace(/(\d{3})(?=\d)/g,"$1"+
a.numbers.output.thousandsSeparator):m[0])+(m[1].length?a.numbers.output.decimalMark+m[1]:"")}}!0===a.escape&&(e=escape(e));"function"===typeof a.onCellData&&(e=a.onCellData(f,h,d,e))}return e}function ma(f,a,d){return a+"-"+d.toLowerCase()}function N(f,a){var d=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/.exec(f),e=a;d&&(e=[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])]);return e}function ga(f){var a=D(f,"text-align"),d=D(f,"font-weight"),e=D(f,"font-style"),g="";"start"==a&&(a="rtl"==D(f,"direction")?
"right":"left");700<=d&&(g="bold");"italic"==e&&(g+=e);""==g&&(g="normal");a={style:{align:a,bcolor:N(D(f,"background-color"),[255,255,255]),color:N(D(f,"color"),[0,0,0]),fstyle:g},colspan:parseInt(b(f).attr("colspan"))||0,rowspan:parseInt(b(f).attr("rowspan"))||0};null!==f&&(f=f.getBoundingClientRect(),a.rect={width:f.width,height:f.height});return a}function D(a,h){try{return window.getComputedStyle?(h=h.replace(/([a-z])([A-Z])/,ma),window.getComputedStyle(a,null).getPropertyValue(h)):a.currentStyle?
a.currentStyle[h]:a.style[h]}catch(d){}return""}function O(a,h,d){h=D(a,h).match(/\d+/);if(null!==h){h=h[0];a=a.parentElement;var e=document.createElement("div");e.style.overflow="hidden";e.style.visibility="hidden";a.appendChild(e);e.style.width=100+d;d=100/e.offsetWidth;a.removeChild(e);return h*d}return 0}function V(){if(!(this instanceof V))return new V;this.SheetNames=[];this.Sheets={}}function na(a){for(var h=new ArrayBuffer(a.length),d=new Uint8Array(h),e=0;e!=a.length;++e)d[e]=a.charCodeAt(e)&
255;return h}function oa(a){for(var h={},d={s:{c:1E7,r:1E7},e:{c:0,r:0}},e=0;e!=a.length;++e)for(var b=0;b!=a[e].length;++b){d.s.r>e&&(d.s.r=e);d.s.c>b&&(d.s.c=b);d.e.r<e&&(d.e.r=e);d.e.c<b&&(d.e.c=b);var l={v:a[e][b]};if(null!=l.v){var m=XLSX.utils.encode_cell({c:b,r:e});"number"===typeof l.v?l.t="n":"boolean"===typeof l.v?l.t="b":l.v instanceof Date?(l.t="n",l.z=XLSX.SSF._table[14],l.v=datenum(l.v)):l.t="s";h[m]=l}}1E7>d.s.c&&(h["!ref"]=XLSX.utils.encode_range(d));return h}function T(a){var h=0,
d,e,b;if(0===a.length)return h;d=0;for(b=a.length;d<b;d++)e=a.charCodeAt(d),h=(h<<5)-h+e,h|=0;return h}function C(a,h,d){var e=window.navigator.userAgent;if(0<e.indexOf("MSIE ")||e.match(/Trident.*rv\:11\./)){if(h=document.createElement("iframe"))document.body.appendChild(h),h.setAttribute("style","display:none"),h.contentDocument.open("txt/html","replace"),h.contentDocument.write(d),h.contentDocument.close(),h.focus(),h.contentDocument.execCommand("SaveAs",!0,a),document.body.removeChild(h)}else if(e=
document.createElement("a")){e.style.display="none";e.download=a;0<=h.toLowerCase().indexOf("base64,")?e.href=h+F(d):e.href=h+encodeURIComponent(d);document.body.appendChild(e);if(document.createEvent)null==P&&(P=document.createEvent("MouseEvents")),P.initEvent("click",!0,!1),e.dispatchEvent(P);else if(document.createEventObject)e.fireEvent("onclick");else if("function"==typeof e.onclick)e.onclick();document.body.removeChild(e)}}function F(a){var h="",d,e,b,l,m,g,k=0;a=a.replace(/\x0d\x0a/g,"\n");
e="";for(b=0;b<a.length;b++)l=a.charCodeAt(b),128>l?e+=String.fromCharCode(l):(127<l&&2048>l?e+=String.fromCharCode(l>>6|192):(e+=String.fromCharCode(l>>12|224),e+=String.fromCharCode(l>>6&63|128)),e+=String.fromCharCode(l&63|128));for(a=e;k<a.length;)d=a.charCodeAt(k++),e=a.charCodeAt(k++),b=a.charCodeAt(k++),l=d>>2,d=(d&3)<<4|e>>4,m=(e&15)<<2|b>>6,g=b&63,isNaN(e)?m=g=64:isNaN(b)&&(g=64),h=h+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);return h}var a={consoleLog:!1,csvEnclosure:'"',csvSeparator:",",csvUseBOM:!0,displayTableName:!1,escape:!1,excelstyles:[],fileName:"tableExport",htmlContent:!1,ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,
fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"left",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:245},tableExport:{onAfterAutotable:null,onBeforeAutotable:null,onTable:null,outputImages:!0}}},numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onCellData:null,onCellHtmlData:null,outputMode:"file",pdfmake:{enabled:!1},tbodySelector:"tr",
tfootSelector:"tr",theadSelector:"tr",tableName:"myTableName",type:"csv",worksheetName:"xlsWorksheetName"},t=this,P=null,q=[],k=[],p=0,z=[],n="",H=[];b.extend(!0,a,v);H=R(t);if("csv"==a.type||"txt"==a.type){var W=function(f,h,d){f.each(function(){n="";y(this,h,p,d+f.length,function(f,b,d){var h=n,g="";if(null!=f)if(f=x(f,b,d),b=null===f||""==f?"":f.toString(),f instanceof Date)g=a.csvEnclosure+f.toLocaleString()+a.csvEnclosure;else if(g=U(b,a.csvEnclosure,a.csvEnclosure+a.csvEnclosure),0<=g.indexOf(a.csvSeparator)||
/[\r\n ]/g.test(g))g=a.csvEnclosure+g+a.csvEnclosure;n=h+(g+a.csvSeparator)});n=b.trim(n).substring(0,n.length-1);0<n.length&&(0<E.length&&(E+="\n"),E+=n);p++});return f.length},E="",I=0,p=0,I=I+W(b(t).find("thead").first().find(a.theadSelector),"th,td",I);b(t).find("tbody").each(function(){I+=W(b(this).find(a.tbodySelector),"td",I)});a.tfootSelector.length&&W(b(t).find("tfoot").first().find(a.tfootSelector),"td",I);E+="\n";!0===a.consoleLog&&console.log(E);if("string"===a.outputMode)return E;if("base64"===
a.outputMode)return F(E);try{var A=new Blob([E],{type:"text/"+("csv"==a.type?"csv":"plain")+";charset=utf-8"});saveAs(A,a.fileName+"."+a.type,"csv"!=a.type||!1===a.csvUseBOM)}catch(f){C(a.fileName+"."+a.type,"data:text/"+("csv"==a.type?"csv":"plain")+";charset=utf-8,"+("csv"==a.type&&a.csvUseBOM?"\ufeff":""),E)}}else if("sql"==a.type){var p=0,u="INSERT INTO `"+a.tableName+"` (",q=b(t).find("thead").first().find(a.theadSelector);q.each(function(){y(this,"th,td",p,q.length,function(a,b,d){u+="'"+x(a,
b,d)+"',"});p++;u=b.trim(u);u=b.trim(u).substring(0,u.length-1)});u+=") VALUES ";b(t).find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&k.push.apply(k,b(t).find("tfoot").find(a.tfootSelector));b(k).each(function(){n="";y(this,"td",p,q.length+k.length,function(a,b,d){n+="'"+x(a,b,d)+"',"});3<n.length&&(u+="("+n,u=b.trim(u).substring(0,u.length-1),u+="),");p++});u=b.trim(u).substring(0,u.length-1);u+=";";!0===a.consoleLog&&console.log(u);if("string"===
a.outputMode)return u;if("base64"===a.outputMode)return F(u);try{A=new Blob([u],{type:"text/plain;charset=utf-8"}),saveAs(A,a.fileName+".sql")}catch(f){C(a.fileName+".sql","data:application/sql;charset=utf-8,",u)}}else if("json"==a.type){var J=[],q=b(t).find("thead").first().find(a.theadSelector);q.each(function(){var a=[];y(this,"th,td",p,q.length,function(b,d,e){a.push(x(b,d,e))});J.push(a)});var X=[];b(t).find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&
k.push.apply(k,b(t).find("tfoot").find(a.tfootSelector));b(k).each(function(){var a={},h=0;y(this,"td",p,q.length+k.length,function(b,e,g){J.length?a[J[J.length-1][h]]=x(b,e,g):a[h]=x(b,e,g);h++});0==b.isEmptyObject(a)&&X.push(a);p++});v="";v="head"==a.jsonScope?JSON.stringify(J):"data"==a.jsonScope?JSON.stringify(X):JSON.stringify({header:J,data:X});!0===a.consoleLog&&console.log(v);if("string"===a.outputMode)return v;if("base64"===a.outputMode)return F(v);try{A=new Blob([v],{type:"application/json;charset=utf-8"}),
saveAs(A,a.fileName+".json")}catch(f){C(a.fileName+".json","data:application/json;charset=utf-8;base64,",v)}}else if("xml"===a.type){var p=0,B='<?xml version="1.0" encoding="utf-8"?>',B=B+"<tabledata><fields>",q=b(t).find("thead").first().find(a.theadSelector);q.each(function(){y(this,"th,td",p,q.length,function(a,b,d){B+="<field>"+x(a,b,d)+"</field>"});p++});var B=B+"</fields><data>",ha=1;b(t).find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&k.push.apply(k,
b(t).find("tfoot").find(a.tfootSelector));b(k).each(function(){var a=1;n="";y(this,"td",p,q.length+k.length,function(b,d,e){n+="<column-"+a+">"+x(b,d,e)+"</column-"+a+">";a++});0<n.length&&"<column-1></column-1>"!=n&&(B+='<row id="'+ha+'">'+n+"</row>",ha++);p++});B+="</data></tabledata>";!0===a.consoleLog&&console.log(B);if("string"===a.outputMode)return B;if("base64"===a.outputMode)return F(B);try{A=new Blob([B],{type:"application/xml;charset=utf-8"}),saveAs(A,a.fileName+".xml")}catch(f){C(a.fileName+
".xml","data:application/xml;charset=utf-8;base64,",B)}}else if("excel"==a.type||"xls"==a.type||"word"==a.type||"doc"==a.type){v="excel"==a.type||"xls"==a.type?"excel":"word";var K="excel"==v?"xls":"doc",r='xmlns:x="urn:schemas-microsoft-com:office:'+v+'"',G="";b(t).filter(function(){return"none"!=b(this).data("tableexport-display")&&(b(this).is(":visible")||"always"==b(this).data("tableexport-display"))}).each(function(){var f=b(this);p=0;H=R(this);G+="<table><thead>";q=f.find("thead").first().find(a.theadSelector);
q.each(function(){n="";y(this,"th,td",p,q.length,function(f,d,e){if(null!=f){var g="";n+="<th";for(var l in a.excelstyles)if(a.excelstyles.hasOwnProperty(l)){var m=b(f).css(a.excelstyles[l]);""!=m&&"0px none rgb(0, 0, 0)"!=m&&(""==g&&(g='style="'),g+=a.excelstyles[l]+":"+m+";")}""!=g&&(n+=" "+g+'"');b(f).is("[colspan]")&&(n+=' colspan="'+b(f).attr("colspan")+'"');b(f).is("[rowspan]")&&(n+=' rowspan="'+b(f).attr("rowspan")+'"');n+=">"+x(f,d,e)+"</th>"}});0<n.length&&(G+="<tr>"+n+"</tr>");p++});G+=
"</thead><tbody>";f.find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&k.push.apply(k,f.find("tfoot").find(a.tfootSelector));b(k).each(function(){var f=b(this);n="";y(this,"td",p,q.length+k.length,function(d,e,g){if(null!=d){var l="",m=b(d).data("tableexport-msonumberformat");"undefined"==typeof m&&"function"===typeof a.onMsoNumberFormat&&(m=a.onMsoNumberFormat(d,e,g));"undefined"!=typeof m&&""!=m&&(l="style=\"mso-number-format:'"+m+"'");n+="<td";
for(var k in a.excelstyles)a.excelstyles.hasOwnProperty(k)&&(m=b(d).css(a.excelstyles[k]),""==m&&(m=f.css(a.excelstyles[k])),""!=m&&"0px none rgb(0, 0, 0)"!=m&&"rgba(0, 0, 0, 0)"!=m&&(""==l&&(l='style="'),l+=a.excelstyles[k]+":"+m+";"));""!=l&&(n+=" "+l+'"');b(d).is("[colspan]")&&(n+=' colspan="'+b(d).attr("colspan")+'"');b(d).is("[rowspan]")&&(n+=' rowspan="'+b(d).attr("rowspan")+'"');n+=">"+x(d,e,g)+"</td>"}});0<n.length&&(G+="<tr>"+n+"</tr>");p++});a.displayTableName&&(G+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+
x(b("<p>"+a.tableName+"</p>"))+"</td></tr>");G+="</tbody></table>";!0===a.consoleLog&&console.log(G)});r='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+r+' xmlns="http://www.w3.org/TR/REC-html40">'+('<meta http-equiv="content-type" content="application/vnd.ms-'+v+'; charset=UTF-8">')+"<head>";"excel"===v&&(r+="\x3c!--[if gte mso 9]>",r+="<xml>",r+="<x:ExcelWorkbook>",r+="<x:ExcelWorksheets>",r+="<x:ExcelWorksheet>",r+="<x:Name>",r+=a.worksheetName,r+="</x:Name>",r+="<x:WorksheetOptions>",
r+="<x:DisplayGridlines/>",r+="</x:WorksheetOptions>",r+="</x:ExcelWorksheet>",r+="</x:ExcelWorksheets>",r+="</x:ExcelWorkbook>",r+="</xml>",r+="<![endif]--\x3e");r+="</head>";r+="<body>";r+=G;r+="</body>";r+="</html>";!0===a.consoleLog&&console.log(r);if("string"===a.outputMode)return r;if("base64"===a.outputMode)return F(r);try{A=new Blob([r],{type:"application/vnd.ms-"+a.type}),saveAs(A,a.fileName+"."+K)}catch(f){C(a.fileName+"."+K,"data:application/vnd.ms-"+v+";base64,",r)}}else if("xlsx"==a.type){var Y=
[],Z=[],p=0,k=b(t).find("thead").first().find(a.theadSelector);b(t).find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&k.push.apply(k,b(t).find("tfoot").find(a.tfootSelector));b(k).each(function(){var a=[];y(this,"th,td",p,k.length,function(b,d,e){if("undefined"!==typeof b&&null!=b){var g=b.getAttribute("colspan"),l=b.getAttribute("rowspan");b=x(b,d,e);""!==b&&b==+b&&(b=+b);Z.forEach(function(b){if(p>=b.s.r&&p<=b.e.r&&a.length>=b.s.c&&a.length<=b.e.c)for(var e=
0;e<=b.e.c-b.s.c;++e)a.push(null)});if(l||g)g=g||1,Z.push({s:{r:p,c:a.length},e:{r:p+(l||1)-1,c:a.length+g-1}});a.push(""!==b?b:null);if(g)for(l=0;l<g-1;++l)a.push(null)}});Y.push(a);p++});v=new V;K=oa(Y);K["!merges"]=Z;v.SheetNames.push(a.worksheetName);v.Sheets[a.worksheetName]=K;v=XLSX.write(v,{bookType:a.type,bookSST:!1,type:"binary"});try{A=new Blob([na(v)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; charset=UTF-8"}),saveAs(A,a.fileName+"."+a.type)}catch(f){C(a.fileName+
"."+a.type,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; charset=UTF-8",Y)}}else if("png"==a.type)html2canvas(b(t)[0]).then(function(b){b=b.toDataURL();b=b.substring(22);for(var h=atob(b),d=new ArrayBuffer(h.length),e=new Uint8Array(d),g=0;g<h.length;g++)e[g]=h.charCodeAt(g);!0===a.consoleLog&&console.log(h);if("string"===a.outputMode)return h;if("base64"===a.outputMode)return F(b);try{var l=new Blob([d],{type:"image/png"});saveAs(l,a.fileName+".png")}catch(m){C(a.fileName+".png",
"data:image/png,",b)}});else if("pdf"==a.type)if(!0===a.pdfmake.enabled){var aa=[],ba=[],p=0,q=b(this).find("thead").first().find(a.theadSelector);q.each(function(){var a=[];y(this,"th,td",p,q.length,function(b,e,g){a.push(x(b,e,g))});a.length&&ba.push(a);for(var b=aa.length;b<a.length;b++)aa.push("*");p++});b(this).find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&k.push.apply(k,b(this).find("tfoot").find(a.tfootSelector));b(k).each(function(){var a=
[];y(this,"td",p,q.length+k.length,function(b,d,e){a.push(x(b,d,e))});a.length&&ba.push(a);p++});pdfMake.createPdf({pageOrientation:"landscape",content:[{table:{headerRows:q.length,widths:aa,body:ba}}]}).getBuffer(function(b){try{var g=new Blob([b],{type:"application/pdf"});saveAs(g,a.fileName+".pdf")}catch(d){C(a.fileName+".pdf","data:application/pdf;base64,",b)}})}else if(!1===a.jspdf.autotable){var A={dim:{w:O(b(t).first().get(0),"width","mm"),h:O(b(t).first().get(0),"height","mm")},pagesplit:!1},
ia=new jsPDF(a.jspdf.orientation,a.jspdf.unit,a.jspdf.format);ia.addHTML(b(t).first(),a.jspdf.margins.left,a.jspdf.margins.top,A,function(){ca(ia)})}else{var g=a.jspdf.autotable.tableExport;if("string"===typeof a.jspdf.format&&"bestfit"===a.jspdf.format.toLowerCase()){var L={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89]},Q="",M="",ja=0;b(t).filter(":visible").each(function(){if("none"!=b(this).css("display")){var a=O(b(this).get(0),"width","pt");
if(a>ja){a>L.a0[0]&&(Q="a0",M="l");for(var g in L)L.hasOwnProperty(g)&&L[g][1]>a&&(Q=g,M="l",L[g][0]>a&&(M="p"));ja=a}}});a.jspdf.format=""==Q?"a4":Q;a.jspdf.orientation=""==M?"w":M}g.doc=new jsPDF(a.jspdf.orientation,a.jspdf.unit,a.jspdf.format);!0===g.outputImages&&(g.images={});"undefined"!=typeof g.images&&(b(t).filter(function(){return"none"!=b(this).data("tableexport-display")&&(b(this).is(":visible")||"always"==b(this).data("tableexport-display"))}).each(function(){var f=0;q=b(this).find("thead").find(a.theadSelector);
b(this).find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&k.push.apply(k,b(this).find("tfoot").find(a.tfootSelector));b(k).each(function(){colKey=0;y(this,"td",q.length+f,q.length+k.length,function(a,d,e){"undefined"!==typeof a&&null!=a&&(d=b(a).children(),"undefined"!=typeof d&&0<d.length&&ea(a,d,g))});f++})}),q=[],k=[]);ka(g,function(f){b(t).filter(function(){return"none"!=b(this).data("tableexport-display")&&(b(this).is(":visible")||"always"==
b(this).data("tableexport-display"))}).each(function(){var f,d=0;H=R(this);g.columns=[];g.rows=[];g.rowoptions={};if("function"===typeof g.onTable&&!1===g.onTable(b(this),a))return!0;a.jspdf.autotable.tableExport=null;var e=b.extend(!0,{},a.jspdf.autotable);a.jspdf.autotable.tableExport=g;e.margin={};b.extend(!0,e.margin,a.jspdf.margins);e.tableExport=g;"function"!==typeof e.beforePageContent&&(e.beforePageContent=function(a){1==a.pageCount&&a.table.rows.concat(a.table.headerRow).forEach(function(b){0<
b.height&&(b.height+=(2-1.15)/2*b.styles.fontSize,a.table.height+=(2-1.15)/2*b.styles.fontSize)})});"function"!==typeof e.createdHeaderCell&&(e.createdHeaderCell=function(a,d){a.styles=b.extend({},d.row.styles);if("undefined"!=typeof g.columns[d.column.dataKey]){var f=g.columns[d.column.dataKey];if("undefined"!=typeof f.rect){var h;a.contentWidth=f.rect.width;if("undefined"==typeof g.heightRatio||0==g.heightRatio)h=d.row.raw[d.column.dataKey].rowspan?d.row.raw[d.column.dataKey].rect.height/d.row.raw[d.column.dataKey].rowspan:
d.row.raw[d.column.dataKey].rect.height,g.heightRatio=a.styles.rowHeight/h;h=d.row.raw[d.column.dataKey].rect.height*g.heightRatio;h>a.styles.rowHeight&&(a.styles.rowHeight=h)}"undefined"!=typeof f.style&&!0!==f.style.hidden&&(a.styles.halign=f.style.align,"inherit"===e.styles.fillColor&&(a.styles.fillColor=f.style.bcolor),"inherit"===e.styles.textColor&&(a.styles.textColor=f.style.color),"inherit"===e.styles.fontStyle&&(a.styles.fontStyle=f.style.fstyle))}});"function"!==typeof e.createdCell&&(e.createdCell=
function(a,b){var d=g.rowoptions[b.row.index+":"+b.column.dataKey];"undefined"!=typeof d&&"undefined"!=typeof d.style&&!0!==d.style.hidden&&(a.styles.halign=d.style.align,"inherit"===e.styles.fillColor&&(a.styles.fillColor=d.style.bcolor),"inherit"===e.styles.textColor&&(a.styles.textColor=d.style.color),"inherit"===e.styles.fontStyle&&(a.styles.fontStyle=d.style.fstyle))});"function"!==typeof e.drawHeaderCell&&(e.drawHeaderCell=function(a,b){var d=g.columns[b.column.dataKey];return(1!=d.style.hasOwnProperty("hidden")||
!0!==d.style.hidden)&&0<=d.rowIndex?da(a,b,d):!1});"function"!==typeof e.drawCell&&(e.drawCell=function(a,b){var d=g.rowoptions[b.row.index+":"+b.column.dataKey];if(da(a,b,d)){g.doc.rect(a.x,a.y,a.width,a.height,a.styles.fillStyle);if("undefined"!=typeof d&&"undefined"!=typeof d.kids&&0<d.kids.length){var e=a.height/d.rect.height;if(e>g.dh||"undefined"==typeof g.dh)g.dh=e;g.dw=a.width/d.rect.width;fa(a,d.kids,g)}g.doc.autoTableText(a.text,a.textPos.x,a.textPos.y,{halign:a.styles.halign,valign:a.styles.valign})}return!1});
g.headerrows=[];q=b(this).find("thead").find(a.theadSelector);q.each(function(){f=0;g.headerrows[d]=[];y(this,"th,td",d,q.length,function(a,b,e){var k=ga(a);k.title=x(a,b,e);k.key=f++;k.rowIndex=d;g.headerrows[d].push(k)});d++});0<d&&b.each(g.headerrows[d-1],function(){obj=1<d&&null==this.rect?g.headerrows[d-2][this.key]:this;null!=obj&&g.columns.push(obj)});var p=0;k=[];b(this).find("tbody").each(function(){k.push.apply(k,b(this).find(a.tbodySelector))});a.tfootSelector.length&&k.push.apply(k,b(this).find("tfoot").find(a.tfootSelector));
b(k).each(function(){var a=[];f=0;y(this,"td",d,q.length+k.length,function(d,e,k){if("undefined"===typeof g.columns[f]){var n={title:"",key:f,style:{hidden:!0}};g.columns.push(n)}"undefined"!==typeof d&&null!=d?(n=ga(d),n.kids=b(d).children()):(n=b.extend(!0,{},g.rowoptions[p+":"+(f-1)]),n.colspan=-1);g.rowoptions[p+":"+f++]=n;a.push(x(d,e,k))});a.length&&(g.rows.push(a),p++);d++});if("function"===typeof g.onBeforeAutotable)g.onBeforeAutotable(b(this),g.columns,g.rows,e);g.doc.autoTable(g.columns,
g.rows,e);if("function"===typeof g.onAfterAutotable)g.onAfterAutotable(b(this),e);a.jspdf.autotable.startY=g.doc.autoTableEndPosY()+e.margin.top});ca(g.doc);"undefined"!=typeof g.headerrows&&(g.headerrows.length=0);"undefined"!=typeof g.columns&&(g.columns.length=0);"undefined"!=typeof g.rows&&(g.rows.length=0);delete g.doc;g.doc=null})}return this}})})(jQuery);
